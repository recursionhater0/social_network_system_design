# Social Network For Tourists

## Требования

### Функциональные требования

- публикация постов из путешествий с фотографиями, небольшим описанием и привязкой к конкретному месту путешествия;
- оценка и комментарии постов других путешественников;
- подписка на других путешественников, чтобы следить за их активностью;
- поиск популярных мест для путешествий и просмотр постов с этих мест;
- просмотр ленты других путешественников и ленты пользователя, основанной на подписках в обратном хронологическом порядке;

### Нефункциональные требования

#### Аудитория приложения

- Количество пользователей.
  - 100 000 DAU
- Поведение пользователей.
  - Один пользователь в среднем в день:
    - будет создавать 5 постов;
    - будет оставлять 3 комментария;
    - будет ставить 5 реакций;
    - будет подписываться на 5 пользователей;
    - будет искать 20 мест для путешествий;
    - будет читать 30 постов в ленте;
    - будет читать 20 комментариев;
- Регионы использования приложения.
  - Только в странах СНГ.

#### Особенности приложения

- Сезонность приложения.
  - Высокий сезон (май-сентябрь) - нагрузка от обычной в 3 раза больше
- Условия хранения данных.
  - Храним всегда
- Лимиты и ограничения
  - Один пользователь в день:
    - может создавать не больше 20 постов;
    - может оставлять не больше 50 комментариев;
    - может ставить не больше 100 реакций;
    - может подписываться на не больше 30 пользователей;
    - может искать неограниченное количество мест для путешествий;
    - может читать неограниченное количество постов в ленте;
  - Максимальное количество символов в 1 посте равно 63 206.
  - Максимальное количество картинок в 1 посте равно 10.
  - Максимальное количество символов в 1 комментарии 8 000.
  - Максимальное количество картинок в 1 комментарии 1.
  - 1 картинка может весить не больше 5Mb.
  - В среднем на 1 посте 15 000 реакций.
- Временные ограничения.
  - один пост должен публиковаться не дольше 1 секунды;
  - счетчик реакций на сообщения должен обновляться не дольше 10 секунд;
  - комментарий должен публиковаться не дольше 1 секунды;
  - подписка на человека должна срабатывать не дольше 3 секунд;
  - поиск мест для путешествий должен работать не дольше 2 секунд;
  - посты в ленте должны загружаться не дольше 2 секунд;
- Доступность приложения
  - 99.99% - в год простой не больше 52.60 минут.

## Оценку нагрузки

### Посты

#### RPS

```
1. RPS (write) = 100 000 * 5 (в среднем создает 1 пользователь) / 86 400 = 5.78
2. RPS (read) = 100 000 * 30 / 86 400 = 34.7
```

#### Traffic

Будем считать по максимуму. 1 пользователь создал пост на 63 206 символов. Так как аудитория стран СНГ, то с высокой
долей вероятности алфавит будет кириллицей. Символ из кириллицы занимает 2 байта. Следовательно,

```
63 206 символов × 2 байта = 126 412 байт ≈ 123 KB
```

Так же допустим, что пользователь в среднем загружает 4 картинки по 4 Mb. Тогда:

```
4 картинок × 4 Mb (средний) = 16 MB = 16 384 KB
```

Если сложить картинки и текст, то выйдет:

```
16 384 KB + 123 KB = 16 507 Kb
```

Так же есть метаинформация: автор поста, время, геолокация. Предположим, что автор - это некий UUID (16 байт). Время поста - timestamp (8 байт). Геолокация - это
координаты (16 байт) + название места (50 байт). Тогда размер метаинформации

```
16 + 8 + 16 + 50 = 90 B = 0.088 KB
``` 

Метаинформацией можно пренебречь

```
1. Traffic (write) = 5.78 * 16 507 Kb = 95 410 Kb = 95 Mb 
2. Traffic (read) = 34.7 * 16 507 Kb = 572 792 Kb = 572 Mb
```

### Реакции

#### RPS

```
1. RPS (write) = 100 000 * 5 (в среднем ставит 1 пользователь) / 86 400 = 5.78
```

Для расчета чтения реакция я сделал предположение, что пользователь, как правило, читает посты и редко смотрит реакции
на них.

#### Traffic

Одна реакция - это эмодзи. Эмодзи занимают 4 байта.

```
1. Traffic (write) = 5.78 * 4 = 23.1 B
```

### Комментарии

#### RPS

```
1. RPS (write) = 100 000 * 3 / 86 400 = 3.47
2. RPS (read) = 100 000 * 20 / 86 400 = 23.1
```

#### Traffic

Предположим, что пользователь использует все 8 000 символов для комментариев. Так как аудитория стран СНГ, то с высокой
долей вероятности алфавит будет кириллицей. Символ из кириллицы занимает 2 байта. Следовательно,

```
8 000 символов × 2 байта = 16 000 B ≈ 16 Kb
```

```
1. Traffic (write) = 3.47 * 16 KbB = 55 Kb
2. Traffic (read) = 23.1 * 20 * 16 Kb = 7392 Kb
```
