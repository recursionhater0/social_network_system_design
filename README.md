# Social Network For Tourists

## Требования

### Функциональные требования

- публикация постов из путешествий с фотографиями, небольшим описанием и привязкой к конкретному месту путешествия;
- оценка и комментарии постов других путешественников;
- подписка на других путешественников, чтобы следить за их активностью;
- поиск популярных мест для путешествий и просмотр постов с этих мест;
- просмотр ленты других путешественников и ленты пользователя, основанной на подписках в обратном хронологическом порядке;

### Нефункциональные требования

#### Аудитория приложения

- Количество пользователей.
  - 10 000 000 DAU
- Поведение пользователей.
  - Один пользователь в среднем в день:
    - будет создавать 10 постов;
    - будет оставлять 5 комментариев;
    - будет ставить 10 реакций;
    - будет подписываться на 5 пользователей;
    - будет искать 10 мест для путешествий;
    - будет читать 50 постов в ленте;
    - будет читать 30 комментариев;
- Регионы использования приложения.
  - Только в странах СНГ.

#### Особенности приложения

- Сезонность приложения.
  - Летом, когда у всех сезон отпусков.
- Условия хранения данных.
  - Храним всегда
- Лимиты и ограничения
  - Один пользователь в день:
    - может создавать не больше 20 постов;
    - может оставлять не больше 50 комментариев;
    - может ставить не больше 100 реакций;
    - может подписываться на не больше 30 пользователей;
    - может искать неограниченное количество мест для путешествий;
    - может читать неограниченное количество постов в ленте;
  - Максимальное количество символов в 1 посте равно 63 206.
  - Максимальное количество картинок в 1 посте равно 10.
  - Максимальное количество символов в 1 комментарии 8 000.
  - Максимальное количество картинок в 1 комментарии 1.
  - 1 картинка может весить не больше 30Mb.
  - В среднем на 1 посте 15 000 реакций.
- Временные ограничения.
  - один пост должен публиковаться не дольше 5 секунд;
  - счетчик реакций на сообщения должен обновляться не дольше 10 секунд;
  - комментарий должен публиковаться не дольше 5 секунд;
  - подписка на человека должна срабатывать не дольше 3 секунд;
  - поиск мест для путешествий должен работать не дольше 2 секунд;
  - посты в ленте должны загружаться не дольше 2 секунд;
- Доступность приложения
  - 99.99% - в год простой не больше 52.60 минут.

## Оценку нагрузки

### Посты

#### RPS

```
1. RPS (write) = 10 000 000 * 10 (в среднем создает 1 пользователь) / 86 400 = 1157.4
2. RPS (read) = 10 000 000 * 50 / 86 400 = 5787.03
```

#### Traffic

Будем считать по максимуму. 1 пользователь создал пост на 63 206 символов. Так как аудитория стран СНГ, то с высокой
долей вероятности алфавит будет кириллицей. Символ из кириллицы занимает 2 байта. Следовательно,

```
63 206 символов × 2 байта = 126 412 байт ≈ 123 KB
```

Так же допустим, что пользователь в среднем загружает 7 картинок по 4 Mb. Тогда:

```
7 картинок × 4 Mb (средний) = 28 MB = 28 672 KB
```

Если сложить картинки и текст, то выйдет:

```
28 672 KB + 123 KB = 28 795 Kb
```

```
1. Traffic (write) = 1157.4 * 28 795 = 33 327 333 Kb = 32 546.22 MB = 31.78 Gb
2. Traffic (read) = 5787.03 * 28 795 = 166 637 529 Kb = 162 731.96 MB = 158.92 Gb
```

### Реакции

#### RPS

```
1. RPS (write) = 10 000 000 * 10 (в среднем ставит 1 пользователь) / 86 400 = 1 157.40
```

Для расчета чтения реакция я сделал предположение, что пользователь, как правило, читает посты и редко смотрит реакции
на них.

#### Traffic

Одна реакция - это эмодзи. Эмодзи занимают 4 байта.

```
1. Traffic (write) = 1 157.40 * 4 = 4629.6 B
```

### Комментарии

#### RPS

```
1. RPS (write) = 10 000 000 * 5 / 86 400 = 578.7
2. RPS (read) = 10 000 000 * 30 / 86 400 = 3 472.2
```

#### Traffic

Предположим, что пользователь использует все 8 000 символов для комментариев. Так как аудитория стран СНГ, то с высокой
долей вероятности алфавит будет кириллицей. Символ из кириллицы занимает 2 байта. Следовательно,

```
8 000 символов × 2 байта = 16 000 B ≈ 16 Kb
```

```
1. Traffic (write) = 578.7 * 16 000 B = 9 259 000 B = 9 042.97 Kb
2. Traffic (read) = 3 472.2 * 30 * 16 Kb = 1 666 656 Kb = 1.6 Mb
```
